<?php
/**
 * Gravity Perks // Nested Forms // Append Post ID to GPNF cookie name
 * https://gravitywiz.com/documentation/gravity-forms-nested-forms/
 *
 * This example shows how you might use this filter to alter the session cookie name. 
 * By default GPNF’s cookies are named gpnf_form_session_xx where xx is the form’s ID. 
 * Here we append the post ID as well to ensure that a form could exist on multiple pages with independent child entries.
 */
add_filter( 'gpnf_cookie_name', function ( $name, $form_id ) {

	$id = get_the_ID(); // Get the current ID from WP

    $id = ( $id ) ? $id : url_to_postid( $_SERVER['HTTP_REFERER'] ); // Check referrer for the ID in AJAX calls

    if ( $id ) {
	
        $name = sprintf( '%s_%s', $name, $id );
	}

	return $name;

}, 10, 2 );
